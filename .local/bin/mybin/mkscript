#!/bin/sh

file="${1}"

[ -z "${file}" ] && { echo "Please supply a script name to create" >&2; exit 1; }
[ -f "${file}" ] && { echo "${file} already exists, aborting" >&2; exit 1; }

mkdir -p "$(dirname "${file}")"

cat > "${file}" << EOB
#!/bin/sh

set -o errexit
set -o nounset
set -o pipefail

usage(){
	cat <<EOF
Usage: \${0##*/} [OPTION]... [FILE]
Some text here.

  -h, --help            display this help and exit
EOF
	exit
}

# parse options
TEMP=\$(getopt -o 'h' -l 'help' -n "\$0" -- "\$@")
[ \$? -ne 0 ] && exit 1
eval set -- "\$TEMP"
unset TEMP
while true; do
	case "\$1" in
		'-h'|'--help') usage ;;
		'--')          break ;;
		*) echo 'Internal error!' >&2; exit 1 ;;
	esac
done

echo "hello world"
EOB

chmod +x "${file}"

"$EDITOR" "${file}"
