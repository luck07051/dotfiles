#!/bin/sh

dmenu="${DMENU:-dmenu -i}"

case "$(ps h 1 | awk '{print $NF}')" in
	systemd)
list="$(cat <<EOF
lock;       slock
shut down;  systemctl poweroff
reboot;     systemctl reboot
log out;    loginctl terminate-session ${XDG_SESSION_ID-}
suspend;    systemctl suspend
hibernate;  systemctl hibernate
EOF
)"
	;;
	runit)
list="$(cat <<EOF
shut down;  doas poweroff
reboot;     doas reboot
log out;    loginctl terminate-session ${XDG_SESSION_ID-}
EOF
)"
	;;
esac

selected=$(echo "$list" | cut -d';' -f1 | $dmenu -p "POWER")

# [ -n "$option" ] &&
# [ "$(printf "No\nYes" | dmenu -i -p "Do you want to $option?")" = "Yes" ] &&
#   eval "$(echo "$list" | grep "$option" | sed 's/.*;\ \+//')"

[ -n "$selected" ] &&
	eval "$(echo "$list" | grep "$selected;" | sed 's/.*;\s\+//')"
